(this["webpackJsonpwindmill-dashboard-react"]=this["webpackJsonpwindmill-dashboard-react"]||[]).push([[47],{1188:function(e,t,a){"use strict";a.r(t);var l=a(19),n=a(6),r=a(5),c=a.n(r),o=a(12),s=a(3),u=a(0),m=a.n(u),i=a(21),d=a.n(i),p=a(9),b=a.n(p),f=a(18),E=(a(35),a(2)),v=a(10),g=(a(197),a(43)),h=a(42);a(36);t.default=function(){var e=Object(u.useContext)(g.a),t=(e.bbaropen,e.setBBarOpen),a=e.setAssetDetails,r=(e.assetdetails,Object(u.useState)(0)),i=Object(s.a)(r,2),p=i[0],O=i[1],x=Object(u.useContext)(h.a),w=(x.topheading,x.setTopHeading),j=Object(u.useState)(!1),N=Object(s.a)(j,2),y=(N[0],N[1],Object(u.useState)(1)),T=Object(s.a)(y,2),C=T[0],k=T[1],S=Object(u.useState)([]),D=Object(s.a)(S,2),M=D[0],B=D[1],F=Object(u.useState)(!0),I=Object(s.a)(F,2),_=I[0],A=I[1],R=Object(u.useState)(""),L=Object(s.a)(R,2),P=L[0],H=L[1],U=Object(u.useState)(""),Y=Object(s.a)(U,2),J=Y[0],z=(Y[1],Object(u.useState)("")),q=Object(s.a)(z,2),G=(q[0],q[1],Object(u.useState)({})),K=Object(s.a)(G,2),Q=K[0],V=(K[1],Object(u.useState)("")),W=Object(s.a)(V,2),X=(W[0],W[1],Object(u.useState)("")),Z=Object(s.a)(X,2),$=(Z[0],Z[1],Object(u.useState)("")),ee=Object(s.a)($,2),te=(ee[0],ee[1],Object(u.useState)(!1)),ae=Object(s.a)(te,2),le=ae[0],ne=ae[1],re=Object(u.useState)(!1),ce=Object(s.a)(re,2),oe=ce[0],se=ce[1],ue=Object(u.useState)(""),me=Object(s.a)(ue,2),ie=me[0],de=me[1],pe=Object(u.useState)(20),be=Object(s.a)(pe,2),fe=be[0],Ee=be[1],ve=Object(u.useState)(!1),ge=Object(s.a)(ve,2),he=ge[0],Oe=ge[1];Object(u.useEffect)((function(){return function(){t(0),a({})}}),[]),Object(u.useEffect)((function(){return w("Leave History"),function(){w("")}}),[]),Object(u.useEffect)((function(){!function(){var e=Object(o.a)(c.a.mark((function e(){var t,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getter called"),t={pages:{page:C,limit:10},filters:{status:P}},e.prev=2,e.next=5,b()({url:"".concat(v.a,"/leave/").concat(f.a.getId(),"/getall"),method:"POST",data:t});case 5:a=e.sent,console.log(a.data.out),Ee(a.data.total),console.log(J,"LOCATIO!!!"),console.log("response.data.out",a.data.out),B(a.data.out),e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(2),e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}()()}),[C,P,_]);var xe=function(e){return function(t){Oe(Object(n.a)(Object(n.a)({},he),{},Object(l.a)({},e,t.target.value)))}};return console.log(Q),m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"mb-64 mt-4"},m.a.createElement(m.a.Fragment,null,m.a.createElement(E.Modal,{isOpen:le,onClose:function(){return ne(!1)}},m.a.createElement(E.ModalHeader,null,"Leave Information."),m.a.createElement(E.ModalBody,null,m.a.createElement("div",null,m.a.createElement("div",{className:"flex-row flex space-x-3 w-full"},m.a.createElement("div",{className:"flex flex-col w-full"},m.a.createElement(E.Label,{className:"w-full"},m.a.createElement("span",null,"Start Date*"),m.a.createElement(E.Input,{className:"mt-1",type:"date",value:he.startdate,onChange:xe("startdate")}))),m.a.createElement("div",{className:"flex flex-col w-full"},m.a.createElement(E.Label,{className:"w-full"},m.a.createElement("span",null,"End Date*"),m.a.createElement(E.Input,{className:"mt-1",type:"date",value:he.enddate,onChange:xe("enddate")}))),m.a.createElement("div",{className:"flex flex-col w-full"},m.a.createElement(E.Label,{className:"w-full"},m.a.createElement("div",null,"Number of Days"),m.a.createElement("div",{className:"text-xl font-semibold my-2 p-2 mx-5 text-black dark:text-white"},""!=he.startdate&&""!=he.enddate?Math.floor((Date.parse(he.enddate)-Date.parse(he.startdate))/864e5)>=0?Math.floor((Date.parse(he.enddate)-Date.parse(he.startdate))/864e5)+1:m.a.createElement(m.a.Fragment,null,"Invalid Dates"):null)))),m.a.createElement("div",{className:"flex-row flex space-x-3 my-2"},m.a.createElement("div",{className:"flex flex-col w-full "},m.a.createElement(E.Label,{className:"w-full"},m.a.createElement("span",null,"Reason"),m.a.createElement("div",{className:"text-lg"},he.reason)))))),m.a.createElement(E.ModalFooter,null,m.a.createElement(E.Button,{className:"w-full sm:w-auto",onClick:Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==he.startdate){e.next=5;break}return de("Start Date necessary"),se(!0),console.log("missing inputs"),e.abrupt("return");case 5:if(""!==he.enddate){e.next=10;break}return de("End Date necessary"),se(!0),console.log("missing inputs"),e.abrupt("return");case 10:if(!(Math.floor((Date.parse(he.enddate)-Date.parse(he.startdate))/864e5)<0)){e.next=15;break}return de("Invalid Date"),se(!0),console.log("invalid inputs"),e.abrupt("return");case 15:return t={id:he._id,update:{employeeName:he.employeeName,employeeId:he.employeeId,reason:he.reason,startdate:he.startdate,enddate:he.enddate,status:"Approved"}},console.log(t),e.next=19,b()({url:"".concat(v.a,"/leave/").concat(f.a.getId(),"/approve"),method:"POST",data:t}).then((function(e){console.log("Updated",e),ne(!1),de("Leave Approved"),se(!0)})).catch((function(e){de("Error"),se(!0),console.log("err",e)}));case 19:A(!_);case 20:case"end":return e.stop()}}),e)})))},"Approve"),m.a.createElement(E.Button,{className:"w-full sm:w-auto",onClick:Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("slected",he),t={id:he._id,update:{status:"Rejected"}},e.next=4,b()({url:"".concat(v.a,"/leave/").concat(f.a.getId(),"/approve"),method:"POST",data:t}).then((function(e){console.log("Updated",e),ne(!1),de("Leave Rejected"),se(!0)})).catch((function(e){de("Error"),se(!0),console.log("err",e)}));case 4:A(!_);case 5:case"end":return e.stop()}}),e)})))},"Reject")))),m.a.createElement(m.a.Fragment,null,m.a.createElement(E.Modal,{isOpen:oe,onClose:function(){return se(!1)}},m.a.createElement(E.ModalHeader,null,ie),m.a.createElement(E.ModalBody,null),m.a.createElement(E.ModalFooter,null,m.a.createElement(E.Button,{className:"w-full sm:w-auto",onClick:function(){return se(!1)}},"Okay!")))),m.a.createElement("div",{className:""},m.a.createElement("div",{class:"my-2 flex sm:flex-row flex-col items-start sm:items-center sm:justify-left h-full space-x-2 "},m.a.createElement("div",{class:"relative mx-1 "},m.a.createElement("select",{class:" shadow-md h-full rounded border block appearance-none w-full bg-white border-gray-400 text-gray-700 py-2 px-4 pr-8 leading-tight focus:outline-none   focus:bg-white focus:border-gray-500",value:P,onChange:function(e){H(e.target.value)}},m.a.createElement("option",{value:"",disabled:!0,selected:!0},"Status"),m.a.createElement("option",{value:""},"All"),m.a.createElement("option",{value:"Submitted"},"Submitted"),m.a.createElement("option",{value:"Rejected"},"Rejected"),m.a.createElement("option",{value:"Approved"},"Approved")),m.a.createElement("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},m.a.createElement("svg",{class:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},m.a.createElement("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})))))),m.a.createElement(E.TableContainer,{className:"mt-4"},m.a.createElement(E.Table,null,m.a.createElement(E.TableHeader,null,m.a.createElement("tr",null,m.a.createElement(E.TableCell,null,"Employee Name"),m.a.createElement(E.TableCell,null,"Start Date"),m.a.createElement(E.TableCell,null,"End Date"),m.a.createElement(E.TableCell,null,"Days"),m.a.createElement(E.TableCell,null,"Reason"),m.a.createElement(E.TableCell,null,"Status"))),m.a.createElement(E.TableBody,null,M.map((function(e,t){return m.a.createElement(E.TableRow,{className:"hover:shadow-lg dark:hover:bg-gray-600 ".concat(p==e._id?"bg-blue-300 shadow-lg dark:bg-gray-600":"white"," "),key:t,onClick:function(){O(e._id)}},m.a.createElement(E.TableCell,null,m.a.createElement("span",{className:"text-sm"},e.employeeName)),m.a.createElement(E.TableCell,null,m.a.createElement("span",{className:"text-sm"},d()(e.startdate).format("DD-MM-YYYY"))),m.a.createElement(E.TableCell,{className:"w-8"},m.a.createElement("div",null,m.a.createElement("p",{className:""},d()(e.enddate).format("DD-MM-YYYY")))),m.a.createElement(E.TableCell,{className:"w-8"},m.a.createElement("div",null,Math.floor((Date.parse(e.enddate)-Date.parse(e.startdate))/864e5)+1)),m.a.createElement(E.TableCell,{className:" w-64 break-all "},m.a.createElement("div",{className:"break-all w-80  overflow-hidden",style:{textOverflow:"clip"}},e.reason)),m.a.createElement(E.TableCell,null,"Submitted"==e.status?m.a.createElement(E.Button,{layout:"outline",className:"text-sm",onClick:function(){Oe(e),ne(!0)}},"Approve"):m.a.createElement("div",{className:"text-purple-700 dark:text-purple-400 font-semibold"},e.status)))})))),m.a.createElement(E.TableFooter,null,m.a.createElement(E.Pagination,{totalResults:fe,resultsPerPage:10,label:"Table navigation",onChange:function(e){k(e)}})))))}},189:function(e,t,a){},197:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var l=a(5),n=a.n(l),r=a(12),c=a(3),o=a(0),s=a.n(o),u=a(9),m=a.n(u),i=a(2),d=a(195),p=(a(189),a(10));function b(e){var t=e.isModalOpen,a=e.setIsModalOpen,l=e.unit,u=e.setUnit,b=e.account,f=e.setAccount,E=e.customer,v=e.setCustomer,g=e.refresh,h=e.setRefresh,O=e.theunitdetails,x=e.setTheUnitDetails,w=Object(o.useState)([]),j=Object(c.a)(w,2),N=j[0],y=j[1],T=Object(o.useState)([]),C=Object(c.a)(T,2),k=C[0],S=C[1],D=Object(o.useState)([]),M=Object(c.a)(D,2),B=M[0],F=M[1],I=Object(o.useState)(0),_=Object(c.a)(I,2),A=_[0],R=_[1],L=Object(o.useState)(""),P=Object(c.a)(L,2),H=P[0],U=P[1],Y=function(e){U(e.target.value)},J=function(){var e=Object(r.a)(n.a.mark((function e(t){var a,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a={search:H,role:1},e.prev=2,e.next=5,m()({url:"".concat(p.a,"/customer/customers"),method:"POST",data:a});case 5:l=e.sent,console.log(l.data),y(l.data),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(2),e.t0;case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}();Object(o.useEffect)((function(){!function(){var e=Object(r.a)(n.a.mark((function e(){var t,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={search:H,role:1},e.prev=1,e.next=4,m()({url:"".concat(p.a,"/customer/customers"),method:"POST",data:t});case 4:a=e.sent,console.log(a.data),y(a.data),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}()()}),[]);var z=function(){var e=Object(r.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v({_id:t._id,customerName:t.name}),f({_id:"",accountName:""}),u({_id:"",unitName:""}),e.prev=3,e.next=6,m.a.post("".concat(p.a,"/customer/accounts"),{customerId:t._id});case 6:a=e.sent,console.log(a.data),S(a.data),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.log("axiosErr",e.t0);case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(r.a)(n.a.mark((function e(t){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),f({_id:t._id,accountName:t.name}),u({_id:"",unitName:""}),e.prev=3,e.next=6,m.a.post("".concat(p.a,"/customer/units"),{accountId:t._id});case 6:a=e.sent,console.log(a.data),F(a.data),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.log("axiosErr",e.t0);case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(r.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("-------------piking unit"),console.log(t),u({_id:t._id,contactPerson:t.contactPerson,contactNo:t.contactNo,unitName:t.unitName});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.Modal,{isOpen:t,onClose:function(){return a(!1)}},s.a.createElement(i.ModalHeader,null,"Select"," ",0==A?s.a.createElement(s.a.Fragment,null,"Customer"):1==A?s.a.createElement(s.a.Fragment,null,"Account"):s.a.createElement(s.a.Fragment,null,"Unit")),s.a.createElement(i.ModalBody,{className:"overflow-y-scroll h-64"},s.a.createElement(d.d,{selectedIndex:A,onSelect:function(e){return R(e)}},s.a.createElement(d.b,null,s.a.createElement(d.a,null,"Customer"),s.a.createElement(d.a,null,"Account"),s.a.createElement(d.a,null,"Unit")),s.a.createElement(d.c,null,s.a.createElement(i.TableContainer,null,s.a.createElement(i.Table,null,s.a.createElement(i.TableHeader,null,s.a.createElement("tr",null,s.a.createElement(i.TableCell,null,"Customer")),s.a.createElement("tr",null,s.a.createElement(i.TableCell,null,s.a.createElement("form",{onSubmit:J},s.a.createElement("input",{className:"block w-full pr-20 text-sm text-black dark:text-gray-300 dark:border-gray-600 dark:bg-gray-700 focus:border-purple-400 focus:outline-none focus:shadow-outline-purple dark:focus:shadow-outline-gray form-input",placeholder:"Search Customers",onChange:Y}))))),s.a.createElement(i.TableBody,null,N.map((function(e,t){return s.a.createElement(i.TableRow,{key:t,className:"hover:bg-purple-200 cursor-pointer",onClick:function(){return z(e)}},s.a.createElement(i.TableCell,null,s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("p",{className:"font-semibold"},e.name)))))})))),s.a.createElement(i.TableFooter,null))),s.a.createElement(d.c,null,s.a.createElement(i.TableContainer,null,s.a.createElement(i.Table,null,s.a.createElement(i.TableHeader,null,s.a.createElement("tr",null,s.a.createElement(i.TableCell,null,"Account"))),s.a.createElement(i.TableBody,null,k.map((function(e,t){return s.a.createElement(i.TableRow,{key:t,className:"hover:bg-purple-200 cursor-pointer",onClick:function(){return q(e)}},s.a.createElement(i.TableCell,null,s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("p",{className:"font-semibold"},e.name)))))})))),s.a.createElement(i.TableFooter,null))),s.a.createElement(d.c,null,s.a.createElement(i.TableContainer,null,s.a.createElement(i.Table,null,s.a.createElement(i.TableHeader,null,s.a.createElement("tr",null,s.a.createElement(i.TableCell,null,"Unit"))),s.a.createElement(i.TableBody,null,B.map((function(e,t){return s.a.createElement(i.TableRow,{key:t,className:"hover:bg-purple-200 cursor-pointer",onClick:function(){return G(e)}},s.a.createElement(i.TableCell,null,s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("p",{className:"font-semibold"},e.unitName)))))})))),s.a.createElement(i.TableFooter,null))))),s.a.createElement(i.ModalFooter,null,s.a.createElement(i.Badge,{className:"mx-2 text-md",type:"success"},"Customer: ",E.customerName),s.a.createElement(i.Badge,{className:"mx-2 text-md",type:"success"},"Account : ",b.accountName),s.a.createElement(i.Badge,{className:"mx-2 text-md",type:"success"},"Unit: ",l.unitName),s.a.createElement(i.Button,{className:"w-full sm:w-auto",onClick:function(){a(!1),h(!g),O&&x(l),S([]),F([])}},"Select"))))}}}]);
//# sourceMappingURL=47.71d28cf1.chunk.js.map