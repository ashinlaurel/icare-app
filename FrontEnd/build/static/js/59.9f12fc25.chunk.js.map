{"version":3,"sources":["pages/Attendance/MarkAttendance.js"],"names":["MarkAttendance","useHistory","setTopHeading","useContext","TopBarContext","useState","statusChecker","setStatusChecker","useEffect","PresentChecker","a","payload","employee","Emp","getId","employeeName","getName","month","moment","format","monthNo","year","monthDayCount","daysInMonth","today","date","dayNo","isPresent","Axios","url","API","method","data","then","console","log","catch","err","handleButton","timeOfMark","className","onClick","disabled"],"mappings":"+QAuHeA,UA1Gf,WACgBC,cAAd,IACQC,EAAkBC,qBAAWC,KAA7BF,cAFgB,EAGkBG,mBAAS,IAH3B,mBAGjBC,EAHiB,KAGFC,EAHE,KAOxBC,qBAAU,WAGR,OAFAN,EAAc,mBACdO,IACO,WACLP,EAAc,OAEf,IAGH,IAAMO,EAAc,uCAAG,4BAAAC,EAAA,6DACjBC,EAAU,CACZC,SAAUC,IAAIC,QACdC,aAAcF,IAAIG,UAClBC,MAAOC,MAASC,OAAO,QACvBC,QAASF,MAASC,OAAO,MACzBE,KAAMH,MAASC,OAAO,QACtBG,cAAeJ,MAASK,cACxBC,MAAO,CACLC,KAAMP,MAASC,OAAO,YACtBO,MAAOR,MAASC,OAAO,MACvBQ,UAAW,KAXM,SAcfC,IAAM,CACVC,IAAI,GAAD,OAAKC,MAAL,uBAAuBjB,IAAIC,QAA3B,oBACHiB,OAAQ,OACRC,KAAMrB,IAELsB,MAAK,SAACD,GAGLE,QAAQC,IAAIH,EAAKA,KAAKL,WACtBpB,EAAiByB,EAAKA,KAAKL,cAE5BS,OAAM,SAACC,GACNH,QAAQC,IAAI,MAAOE,MA1BF,2CAAH,qDA+BdC,EAAY,uCAAG,4BAAA5B,EAAA,6DACfC,EAAU,CACZC,SAAUC,IAAIC,QACdC,aAAcF,IAAIG,UAClBC,MAAOC,MAASC,OAAO,QACvBC,QAASF,MAASC,OAAO,MACzBE,KAAMH,MAASC,OAAO,QACtBG,cAAeJ,MAASK,cACxBC,MAAO,CACLe,WAAYrB,MAASC,OAAO,WAC5BM,KAAMP,MAASC,OAAO,YACtBO,MAAOR,MAASC,OAAO,MACvBQ,UAAW,YAZI,SAebC,IAAM,CACVC,IAAI,GAAD,OAAKC,MAAL,uBAAuBjB,IAAIC,QAA3B,mBACHiB,OAAQ,OACRC,KAAMrB,IAELsB,MAAK,SAACD,GACLE,QAAQC,IAAI,SACZ1B,OAED2B,OAAM,SAACC,GACNH,QAAQC,IAAI,MAAOE,MAzBJ,2CAAH,qDA8BlB,OACE,oCACE,yBAAKG,UAAU,oBACb,kBAAC,OAAD,CAAMA,UAAU,kBACd,kBAAC,WAAD,KACE,yBAAKA,UAAU,qCACZ,IADH,SAEStB,MAASC,OAAO,aAEzB,wBAAIqB,UAAU,SACd,yBAAKA,UAAU,6CACb,kBAAC,SAAD,CACEC,QAAS,WACPH,KAEFI,SAA2B,WAAjBpC,GAEQ,WAAjBA,EACG,iBACA","file":"static/js/59.9f12fc25.chunk.js","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport { API } from \"../../backendapi\";\n\nimport Emp from \"../../helpers/auth/EmpProfile\";\n\nimport { Button, Card, CardBody } from \"@windmill/react-ui\";\n\nimport { TopBarContext } from \"../../context/TopBarContext\";\n\nimport { useHistory } from \"react-router-dom\";\nimport moment from \"moment\";\nimport Axios from \"axios\";\n\nfunction MarkAttendance() {\n  let history = useHistory();\n  const { setTopHeading } = useContext(TopBarContext);\n  const [statusChecker, setStatusChecker] = useState(\"\");\n\n  // ----------------------Heading Use Effect-------------\n\n  useEffect(() => {\n    setTopHeading(\"Mark Attendance\");\n    PresentChecker();\n    return () => {\n      setTopHeading(\"\");\n    };\n  }, []);\n  // -----------------------------------------------------\n\n  const PresentChecker = async () => {\n    let payload = {\n      employee: Emp.getId(),\n      employeeName: Emp.getName(),\n      month: moment().format(\"MMMM\"),\n      monthNo: moment().format(\"MM\"),\n      year: moment().format(\"YYYY\"),\n      monthDayCount: moment().daysInMonth(),\n      today: {\n        date: moment().format(\"DD-MM-YY\"),\n        dayNo: moment().format(\"DD\"),\n        isPresent: \"\",\n      },\n    };\n    await Axios({\n      url: `${API}/attendance/${Emp.getId()}/checkAttendance`,\n      method: \"POST\",\n      data: payload,\n    })\n      .then((data) => {\n        // console.log(\"*******************\");\n        // console.log(data);\n        console.log(data.data.isPresent);\n        setStatusChecker(data.data.isPresent);\n      })\n      .catch((err) => {\n        console.log(\"err\", err);\n        // setErr({ ...err });\n      });\n  };\n\n  const handleButton = async () => {\n    let payload = {\n      employee: Emp.getId(),\n      employeeName: Emp.getName(),\n      month: moment().format(\"MMMM\"),\n      monthNo: moment().format(\"MM\"),\n      year: moment().format(\"YYYY\"),\n      monthDayCount: moment().daysInMonth(),\n      today: {\n        timeOfMark: moment().format(\"hh:mm a\"),\n        date: moment().format(\"DD-MM-YY\"),\n        dayNo: moment().format(\"DD\"),\n        isPresent: \"Present\",\n      },\n    };\n    await Axios({\n      url: `${API}/attendance/${Emp.getId()}/markAttendance`,\n      method: \"POST\",\n      data: payload,\n    })\n      .then((data) => {\n        console.log(\"hello\");\n        PresentChecker();\n      })\n      .catch((err) => {\n        console.log(\"err\", err);\n        // setErr({ ...err });\n      });\n  };\n\n  return (\n    <>\n      <div className=\" w-full md:w-1/4\">\n        <Card className=\"my-8 shadow-md\">\n          <CardBody>\n            <div className=\"dark:text-white text-xl font-bold\">\n              {\" \"}\n              Date: {moment().format(\"DD-MM-YY\")}\n            </div>\n            <hr className=\"my-3\"></hr>\n            <div className=\"flex-row flex items-center justify-center\">\n              <Button\n                onClick={() => {\n                  handleButton();\n                }}\n                disabled={statusChecker == \"Present\" ? true : false}\n              >\n                {statusChecker == \"Present\"\n                  ? \"Already Marked\"\n                  : \"Mark Attendance\"}\n              </Button>\n            </div>\n          </CardBody>\n        </Card>\n      </div>\n    </>\n  );\n}\n\nexport default MarkAttendance;\n"],"sourceRoot":""}