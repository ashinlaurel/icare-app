(this["webpackJsonpwindmill-dashboard-react"]=this["webpackJsonpwindmill-dashboard-react"]||[]).push([[55],{1069:function(e,a,t){"use strict";t.r(a);var l=t(3),n=t.n(l),c=t(10),r=t(2),s=t(0),u=t.n(s),o=t(18),m=t.n(o),i=t(7),d=t.n(i),E=t(15),b=(t(85),t(28),t(1)),g=t(8),p=t(30),f=t(6),O=t(29),S=(t(19),t(111));a.default=function(){var e=Object(s.useState)(!1),a=Object(r.a)(e,2),t=a[0],l=a[1],o=Object(s.useState)(!1),i=Object(r.a)(o,2),C=i[0],v=i[1],j=Object(s.useState)(!1),x=Object(r.a)(j,2),y=x[0],h=x[1],N=Object(s.useContext)(p.a),T=(N.bbaropen,N.setBBarOpen),w=N.setAssetDetails,B=(N.assetdetails,Object(s.useState)(0)),P=Object(r.a)(B,2),k=P[0],M=P[1],A=Object(s.useContext)(O.a),D=(A.topheading,A.setTopHeading),_=Object(s.useState)(!1),R=Object(r.a)(_,2),F=(R[0],R[1],Object(s.useState)(1)),H=Object(r.a)(F,2),U=H[0],Y=H[1],I=Object(s.useState)([]),z=Object(r.a)(I,2),L=z[0],J=z[1],V=Object(s.useState)(""),q=Object(r.a)(V,2),G=q[0],K=q[1],Q=Object(s.useState)(!1),W=Object(r.a)(Q,2),X=(W[0],W[1],Object(s.useState)(!1)),Z=Object(r.a)(X,2),$=(Z[0],Z[1],Object(s.useState)(!1)),ee=Object(r.a)($,2),ae=(ee[0],ee[1],Object(s.useState)(!0)),te=Object(r.a)(ae,2),le=te[0],ne=te[1],ce=Object(s.useState)(!0),re=Object(r.a)(ce,2),se=(re[0],re[1],Object(s.useState)("")),ue=Object(r.a)(se,2),oe=ue[0],me=ue[1],ie=Object(s.useState)(""),de=Object(r.a)(ie,2),Ee=de[0],be=de[1],ge=Object(s.useState)(""),pe=Object(r.a)(ge,2),fe=pe[0],Oe=pe[1],Se=Object(s.useState)(""),Ce=Object(r.a)(Se,2),ve=Ce[0],je=(Ce[1],Object(s.useState)("")),xe=Object(r.a)(je,2),ye=xe[0],he=(xe[1],Object(s.useState)({_id:"",unitName:""})),Ne=Object(r.a)(he,2),Te=(Ne[0],Ne[1],Object(s.useState)({_id:"",customerName:""})),we=Object(r.a)(Te,2),Be=(we[0],we[1],Object(s.useState)({_id:"",accountName:""})),Pe=Object(r.a)(Be,2),ke=(Pe[0],Pe[1],Object(s.useState)({_id:"",enggName:""})),Me=Object(r.a)(ke,2),Ae=Me[0],De=(Me[1],Object(s.useState)(!1)),_e=Object(r.a)(De,2),Re=(_e[0],_e[1],Object(s.useState)({})),Fe=Object(r.a)(Re,2),He=Fe[0],Ue=Fe[1],Ye=Object(s.useState)(""),Ie=Object(r.a)(Ye,2),ze=(Ie[0],Ie[1],Object(s.useState)("")),Le=Object(r.a)(ze,2),Je=(Le[0],Le[1],Object(s.useState)("")),Ve=Object(r.a)(Je,2),qe=Ve[0],Ge=Ve[1],Ke=Object(s.useState)(20),Qe=Object(r.a)(Ke,2),We=Qe[0],Xe=Qe[1],Ze=function(){return u.a.createElement(u.a.Fragment,null,u.a.createElement(b.Modal,{isOpen:t,onClose:function(){return l(!1)}},u.a.createElement(b.ModalHeader,null,"Set Call Status"),u.a.createElement(b.ModalBody,null,u.a.createElement("div",{className:"flex-col flex"},u.a.createElement("div",{className:"font-xl dark:text-white"},"Current Status:"),u.a.createElement(b.Button,{className:"font-xl"},"Set Status"),u.a.createElement(b.Button,{className:"font-xl my-2 mx-10 inline"},"Pending for Allocation"),u.a.createElement(b.Button,{className:"font-xl my-2 mx-10 inline"},"Pending for Allocation"),u.a.createElement(b.Button,{className:"font-xl my-2 mx-10 inline"},"Pending for Allocation"),u.a.createElement(b.Button,{className:"font-xl my-2 mx-10 inline"},"Pending for Allocation"))),u.a.createElement(b.ModalFooter,null,u.a.createElement(b.Button,{className:"w-full sm:w-auto",onClick:Object(c.a)(n.a.mark((function e(){var a,t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("SELECTED",He),a={id:He._id,update:{employeeId:Ae._id,employeeName:Ae.enggName,callStatus:1}},e.prev=2,e.next=5,d()({url:"".concat(g.a,"/call/").concat(E.a.getId(),"/ViewCallsg"),method:"POST",data:a});case 5:e.sent,t=L,console.log(t),t=t.filter((function(e){if(e._id===He._id)return e.callStatus=1,e.employeeName=Ae.enggName,e.employeeId=Ae._id,e;J(t)})),l(!1),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(2),e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,12]])})))},"Confirm Assignment"))))};Object(s.useEffect)((function(){return function(){T(0),w({})}}),[]),Object(s.useEffect)((function(){return D("View Calls"),function(){D("")}}),[]),Object(s.useEffect)((function(){!function(){var e=Object(c.a)(n.a.mark((function e(){var a,t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={pages:{page:U,limit:10},filters:{callStatus:oe,searchquery:qe,fromDate:Ee,toDate:fe}},e.prev=1,e.next=4,d()({url:"".concat(g.a,"/call/").concat(E.a.getId(),"/getall"),method:"POST",data:a});case 4:t=e.sent,Xe(t.data.total),J(t.data.out),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}()()}),[U,ve,ye,le,oe,qe,Ee,fe]);var $e=function(){return u.a.createElement(u.a.Fragment,null,u.a.createElement(b.Modal,{isOpen:C,onClose:function(){return v(!1)}},u.a.createElement(b.ModalHeader,null,"Updated Successfully!"),u.a.createElement(b.ModalBody,null),u.a.createElement(b.ModalFooter,null,u.a.createElement(b.Button,{className:"w-full sm:w-auto",onClick:function(){return v(!1)}},"Okay!"))))};return u.a.createElement(u.a.Fragment,null,u.a.createElement(Ze,null),u.a.createElement($e,null),function(){if(L[G]){var e=L[G],a=L[G].history;return console.log(a),u.a.createElement(u.a.Fragment,null,u.a.createElement(b.Modal,{isOpen:y,onClose:function(){return h(!1)},className:"w-9/12 dark:bg-gray-800 p-10 my-6  bg-gray-50 text-gray-900 dark:text-white  rounded-lg overflow-y-scroll"},u.a.createElement(b.ModalHeader,{className:"flex flex-row justify-between text-xl"},u.a.createElement("div",null,e.name),u.a.createElement("div",null,"Call No: ",u.a.createElement(b.Badge,null,e.callNo)," ")),u.a.createElement(b.ModalBody,null,u.a.createElement("div",{className:"font-semibold text-xl my-2"},"Call History"),u.a.createElement(b.TableContainer,{className:"mt-4"},u.a.createElement(b.Table,null,u.a.createElement(b.TableHeader,null,u.a.createElement("tr",null,u.a.createElement(b.TableCell,null,"Date"),u.a.createElement(b.TableCell,null,"Engineer"),u.a.createElement(b.TableCell,null,"Attended Date"),u.a.createElement(b.TableCell,null,"Start Of Service"),u.a.createElement(b.TableCell,null,"End Of Service"),u.a.createElement(b.TableCell,null,"Status"),u.a.createElement(b.TableCell,null,"Notes"),u.a.createElement(b.TableCell,null,"Action Taken"))),u.a.createElement(b.TableBody,null,a.map((function(e,a){return u.a.createElement(b.TableRow,{className:"hover:shadow-lg dark:hover:bg-gray-600 ".concat(k==e._id?"bg-blue-300 shadow-lg dark:bg-gray-600":"white"," "),key:a,onClick:function(){}},u.a.createElement(b.TableCell,{className:"w-8"},u.a.createElement("div",{className:"flex items-center text-sm "},u.a.createElement("div",null,u.a.createElement("p",{className:"font-semibold"},m()(e.date).format("DD-MM-YYYY"))))),u.a.createElement(b.TableCell,null,u.a.createElement("span",{className:"text-sm"},Object(S.capitalize)(e.engineer))),u.a.createElement(b.TableCell,null,u.a.createElement("span",{className:"text-sm"},e.callAttendDate)),u.a.createElement(b.TableCell,null,u.a.createElement("span",{className:"text-sm"},e.startOfService)),u.a.createElement(b.TableCell,null,u.a.createElement("span",{className:"text-sm"},e.endOfService)),u.a.createElement(b.TableCell,null,u.a.createElement("span",null,0==e.callStatus?u.a.createElement(b.Badge,null,"Not Allocated"):null,1==e.callStatus?u.a.createElement(b.Badge,null,"Pending for Percall Approval"):null,2==e.callStatus?u.a.createElement(b.Badge,null,"Pending for Response"):null,3==e.callStatus?u.a.createElement(b.Badge,null,"Pending for OEM Response"):null,4==e.callStatus?u.a.createElement(b.Badge,null,"Pending for 2nd Response"):null,5==e.callStatus?u.a.createElement(b.Badge,null,"Pending for Customer"):null,6==e.callStatus?u.a.createElement(b.Badge,null,"Under Observation"):null,7==e.callStatus?u.a.createElement(b.Badge,null,"Pending for Others"):null,8==e.callStatus?u.a.createElement(b.Badge,null,"Pending for Spare"):null,9==e.callStatus?u.a.createElement(b.Badge,null,"Spare in Transit"):null,10==e.callStatus?u.a.createElement(b.Badge,null,"Cancelled Calls"):null,11==e.callStatus?u.a.createElement(b.Badge,null,"Closed Calls"):null)),u.a.createElement(b.TableCell,null,u.a.createElement("span",{className:"text-sm "},e.note)),u.a.createElement(b.TableCell,null,u.a.createElement("span",{className:"text-sm"},e.actionTaken)))})))))),u.a.createElement(b.ModalFooter,null)))}}(),u.a.createElement("div",{className:"mb-64 mt-4"},u.a.createElement("div",{className:""},u.a.createElement("div",{class:"my-2 flex sm:flex-row flex-col items-start sm:items-center sm:justify-left h-full space-x-6 "},u.a.createElement(b.Label,{className:""},u.a.createElement("span",null,"From Date"),u.a.createElement("input",{className:"mt-1 p-3 rounded-sm mx-1",type:"date",value:Ee,onChange:function(e){return be(e.target.value)}})),u.a.createElement(b.Label,{className:""},u.a.createElement("span",null,"To Date"),u.a.createElement("input",{className:"mt-1 p-3 rounded-sm mx-1",type:"date",value:fe,onChange:function(e){return Oe(e.target.value)}})),u.a.createElement("div",{class:"relative mx-1 "},u.a.createElement("select",{class:" shadow-md h-full rounded border block appearance-none w-full bg-white border-gray-400 text-gray-700 py-2 px-4 pr-8 leading-tight focus:outline-none   focus:bg-white focus:border-gray-500",value:oe,onChange:function(e){me(e.target.value)}},u.a.createElement("option",{value:"",disabled:!0,selected:!0},"Call Status"),u.a.createElement("option",{value:""},"All"),u.a.createElement("option",{selected:!0,value:"0"},"Not Allocated"),u.a.createElement("option",{value:"1"},"Pending for Percall Approval"),u.a.createElement("option",{value:"2"},"Pending for Response"),u.a.createElement("option",{value:"3"},"Pending for OEM Response"),u.a.createElement("option",{value:"4"},"Pending for 2nd Response"),u.a.createElement("option",{value:"5"},"Pending for Customer"),u.a.createElement("option",{value:"6"},"Under Observation"),u.a.createElement("option",{value:"7"},"Pending for Others"),u.a.createElement("option",{value:"8"},"Pending for Spare"),u.a.createElement("option",{value:"9"},"Spare in Transit"),u.a.createElement("option",{value:"10"},"Cancelled Calls"),u.a.createElement("option",{value:"11"},"Closed Calls")),u.a.createElement("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},u.a.createElement("svg",{class:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},u.a.createElement("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})))),u.a.createElement("div",{class:"block relative xl:ml-64"},u.a.createElement("span",{class:"h-full absolute inset-y-0 left-0 flex items-center pl-2"},u.a.createElement("svg",{viewBox:"0 0 24 24",class:"h-4 w-4 fill-current text-gray-500"},u.a.createElement("path",{d:"M10 4a6 6 0 100 12 6 6 0 000-12zm-8 6a8 8 0 1114.32 4.906l5.387 5.387a1 1 0 01-1.414 1.414l-5.387-5.387A8 8 0 012 10z"}))),u.a.createElement("form",{onSubmit:function(e){e.preventDefault(),ne(!le)}},u.a.createElement("input",{value:qe,onChange:function(e){return Ge(e.target.value)},placeholder:"Search by Call No.",class:"shadow-md z-20 appearance-none rounded border border-gray-400 border-b block pl-8 pr-6 py-2 w-full bg-white text-sm placeholder-gray-400 text-gray-700 focus:bg-white focus:placeholder-gray-600 focus:text-gray-700 focus:outline-none"}))))),u.a.createElement(b.TableContainer,{className:"mt-4"},u.a.createElement(b.Table,null,u.a.createElement(b.TableHeader,null,u.a.createElement("tr",null,u.a.createElement(b.TableCell,null,"Call No"),u.a.createElement(b.TableCell,null,"Date"),u.a.createElement(b.TableCell,null,"Unit Name"),u.a.createElement(b.TableCell,null,"Phone"),u.a.createElement(b.TableCell,null,"Call Status"),u.a.createElement(b.TableCell,null,"Assigned Employee"),u.a.createElement(b.TableCell,null,"Update / History"))),u.a.createElement(b.TableBody,null,L.map((function(e,a){return u.a.createElement(b.TableRow,{className:"hover:shadow-lg dark:hover:bg-gray-600 ".concat(k==e._id?"bg-blue-300 shadow-lg dark:bg-gray-600":"white"," "),key:a,onClick:function(){M(e._id),T(1),Ue(e),console.log("SELECTD",e),w(e.assetId)}},u.a.createElement(b.TableCell,{className:"w-8"},u.a.createElement("div",{className:"flex items-center text-sm "},u.a.createElement("div",null,u.a.createElement("p",{className:"font-semibold"},e.callNo)))),u.a.createElement(b.TableCell,null,u.a.createElement("span",{className:"text-sm"},m()(e.date).format("DD/MM/YYYY"))),u.a.createElement(b.TableCell,null,u.a.createElement("span",{className:"text-sm"},e.unitName)),u.a.createElement(b.TableCell,null,u.a.createElement("span",{className:"text-sm"},e.phone)),u.a.createElement(b.TableCell,null,u.a.createElement("span",null,0==e.callStatus?u.a.createElement(b.Badge,null,"Not Allocated"):null,1==e.callStatus?u.a.createElement(b.Badge,null,"Pending for Percall Approval"):null,2==e.callStatus?u.a.createElement(b.Badge,null,"Pending for Response"):null,3==e.callStatus?u.a.createElement(b.Badge,null,"Pending for OEM Response"):null,4==e.callStatus?u.a.createElement(b.Badge,null,"Pending for 2nd Response"):null,5==e.callStatus?u.a.createElement(b.Badge,null,"Pending for Customer"):null,6==e.callStatus?u.a.createElement(b.Badge,null,"Under Observation"):null,7==e.callStatus?u.a.createElement(b.Badge,null,"Pending for Others"):null,8==e.callStatus?u.a.createElement(b.Badge,null,"Pending for Spare"):null,9==e.callStatus?u.a.createElement(b.Badge,null,"Spare in Transit"):null,10==e.callStatus?u.a.createElement(b.Badge,null,"Cancelled Calls"):null,11==e.callStatus?u.a.createElement(b.Badge,null,"Closed Calls"):null)),u.a.createElement(b.TableCell,null,e.employeeId?u.a.createElement(u.a.Fragment,null,e.employeeName):u.a.createElement(u.a.Fragment,null,"Not Assigned")),u.a.createElement(b.TableCell,null,u.a.createElement("div",{className:"flex justify-start items-center space-x-2"},u.a.createElement(f.b,{key:e._id,to:"/app/call/updatecall/".concat(e._id,"/").concat(e.assetId._id)},u.a.createElement(b.Button,{layout:"outline",onClick:function(){},className:" "},"Update")),u.a.createElement(b.Button,{onClick:function(){K(a),h(!0)},layout:"outline"},"History"))))})))),u.a.createElement(b.TableFooter,null,u.a.createElement(b.Pagination,{totalResults:We,resultsPerPage:10,label:"Table navigation",onChange:function(e){Y(e)}})))))}},111:function(e,a){a.capitalize=function(e){return"string"!==typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)}}}]);
//# sourceMappingURL=55.ae0cc3d5.chunk.js.map